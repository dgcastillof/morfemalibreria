<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Morfema - Libro</title>
    <meta name="description" content="Detalles del libro disponible en Morfema Librería">
    <meta name="keywords" content="libros usados,librería,comprar libros,Morfema">
    <meta name="author" content="Morfema Librería">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="Morfema - Libro">
    <meta property="og:description" content="Detalles del libro disponible en Morfema Librería">
    <meta property="og:image" content="logo400x400fondo.png">
    <meta property="og:url" content="https://morfemalibreria.web.app/libro.html">
    <meta property="og:type" content="book">
    <link rel="canonical" href="https://morfemalibreria.web.app/libro.html">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="icon" href="logo.png">
    <script>
        function loadImage(imgElem) {
            const src = imgElem.getAttribute('data-src');
            if (!src) return;
            const img = new Image();
            img.src = src;
            img.onload = () => {
                imgElem.src = src;
                imgElem.classList.add('loaded');
            };
        }

        async function fetchBook() {
            try {
                const response = await fetch('books.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                const books = await response.json();
                const params = new URLSearchParams(window.location.search);
                const titleParam = params.get('titulo');
                const book = books.find(b => b.titulo === titleParam);
                if (book) {
                    renderBook(book);
                } else {
                    document.getElementById('bookContainer').textContent = 'Libro no encontrado.';
                }
            } catch (error) {
                console.error('Error cargando los datos del libro:', error);
            }
        }

        function renderBook(book) {
            const container = document.getElementById('bookContainer');
            container.innerHTML = `
                <div class="book-detail">
                    <div class="book-img-wrapper">
                        <img src="placeholder.png" data-src="${book.imagen}" alt="${book.titulo}" class="lazy-img">
                        ${book.vendido ? '<span class="sold-badge">VENDIDO</span>' : ''}
                    </div>
                    <h3>${book.titulo}</h3>
                    <p><strong>Autor:</strong> ${book.autor}</p>
                    <p><strong>Idioma:</strong> ${book.idioma}</p>
                    <p><strong>Estado:</strong> ${book.estado}</p>
                    <p><strong>Precio:</strong> ${book.precio}</p>
                </div>`;
            const imgElem = container.querySelector('img.lazy-img');
            loadImage(imgElem);
        }

        document.addEventListener('DOMContentLoaded', fetchBook);
    </script>
</head>
<body>
    <nav class="navbar">
        <a href="index.html">CATÁLOGO USADOS</a>
        <a href="vende.html">VENDÉ TUS LIBROS CON NOSOTROS</a>
        <a href="lee-gratis.html">LEÉ GRATIS</a>
        <a href="talleres.html">TALLERES</a>
    </nav>
    <div class="container" id="bookContainer"></div>
    <div class="footer">
        <p>Contacto:</p>
        <a href="https://www.instagram.com/morfemalibreria" target="_blank">
            <i class="fab fa-instagram"></i> Instagram
        </a>
        <a href="https://wa.me/541135752748" target="_blank">
            <i class="fab fa-whatsapp"></i> WhatsApp
        </a>
    </div>
</body>
</html>
